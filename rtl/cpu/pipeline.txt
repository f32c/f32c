Pipeline stages:

IF - instruction fetch
ID - instruction decode
EX - execute
MEM - memory acces
WB - register writeback



MEM stage stall causes:

- write not acknowledged from RAM
- data not ready from RAM
- must shift data received from RAM
- must shift data to be sent to RAM


EX stage stall causes:

- MEM stage stall
- branch in EX, but next instruction not yet in ID


ID stage stall causes:

- EX stage stall
- load-use hazard: operand target of LD in EX stage
	- must insert bubble in EX


Exception FSM
=============

EI .. enable interrupts
EIP .. exception in progress

#0: EI = 1, IF_ID_EIP = 0, ID_EX_EIP = 0, EX_MEM_EIP = 0:
	- exception flows from ID, accepted in EX stage
	- store EPC

#1: EI = 0, IF_ID_EIP = 0, ID_EX_EIP = 0, EX_MEM_EIP = 1:
	- discards all instructions in EX
	- on IF_ID boundary, wait for a non-branch-delay slot, replace with jr

#2: EI = 0, IF_ID_EIP = 1, ID_EX_EIP = 0, EX_MEM_EIP = 1:
	- discards all instructions in EX and in ID

#3: EI = 0, IF_ID_EIP = 0, ID_EX_EIP = 1, EX_MEM_EIP = 1:
	- discards all instructions in EX

#4: EI = 0, IF_ID_EIP = 0, ID_EX_EIP = 0, EX_MEM_EIP = 0:
	- normal operation, exceptions ignored
