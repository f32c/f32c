Pipeline stages:

IF - instruction fetch
ID - instruction decode
EX - execute
MEM - memory acces
WB - register writeback



MEM stage stall causes:

- write not acknowledged from RAM
- data not ready from RAM
- must shift data received from RAM
- must shift data to be sent to RAM


EX stage stall causes:

- MEM stage stall
- branch in EX, but next instruction not yet in ID


ID stage stall causes:

- EX stage stall
- load-use hazard: operand target of LD in EX stage
	- must insert bubble in EX


Exception FSM
=============

EI .. enable interrupts
EIP .. exception in progress

#0: EI = 1, IF_ID_EIP = 0, EX_MEM_EIP = 0:
	- exception flows from ID, accepted in EX stage
	- store EPC
	- initiate branch to handler address
	- move FSM to state #1

#1: EI = 0, IF_ID_EIP = 0, EX_MEM_EIP = 1:
	- discards all instructions in EX, ignores jumps / branches in ID
	- waits for IF to fetch 1st instr. from exception handler addr
	- move FSM to state #2

#2: EI = 0, IF_ID_EIP = 1, EX_MEM_EIP = 1:
	- discards all instructions in EX
	- move FSM to state #3

#3: EI = 0, IF_ID_EIP = 0, EX_MEM_EIP = 0:
	- normal operation, exceptions ignored
	- ERET / RFE moves FSM to state #0 (EI = 1, EIP = 0)
